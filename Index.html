<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Catatan Hitung - Zalta Gift</title>

<style>
body{font-family:Arial,sans-serif;background:#f5f5f5;padding:10px}
h2,h3{text-align:center;margin:6px 0}
.form{background:#fff;padding:10px;border-radius:6px;margin-bottom:10px}
label{font-size:13px;font-weight:bold}
input{width:100%;height:40px;padding:6px;font-size:16px;font-weight:bold;box-sizing:border-box;border:1px solid #888;border-radius:4px}
input[type=text]{text-align:right}
input[type=number]{text-align:center}
.row{display:flex;gap:6px}

table{width:100%;border-collapse:collapse;background:#fff}
th,td{border:1px solid #ccc;padding:6px;font-size:14px;text-align:center}
th{background:#eee}
.total{text-align:right;font-weight:bold}
td[contenteditable]{background:#fffbe6}
button{width:100%;padding:10px;font-size:16px;margin-top:6px}
.small{width:auto;padding:6px 8px;font-size:13px}
.controls{display:flex;gap:6px;flex-wrap:wrap}
.minus{color:red;font-weight:bold}
.plus{color:green;font-weight:bold}
@media print{.form,button,input{display:none!important}body{background:#fff}}
@page{size:80mm auto;margin:3mm}
</style>
</head>
<body>

<h2>üìí ZALTA GIFT</h2>
<div style="text-align:center;font-size:11px">
  <b>ZALTA GIFT</b><br>
  Barahan RT 05 RW 02 Tarub<br>
  Tawangharjo, Grobogan<br>
  HP / WA: 08816575574 / 081476698677<br>
  <span id="datetime"></span>
</div>

<div class="form">
  <label>Nama Barang</label>
  <input id="iBarang" tabindex="1" placeholder="Ketik nama barang">
  <div class="row" style="margin-top:6px">
    <div style="flex:1">
      <label>Qty</label>
      <input type="number" id="iQty" tabindex="2" placeholder="0">
    </div>
    <div style="flex:1">
      <label>Harga</label>
      <input type="text" id="iHarga" tabindex="3" placeholder="0" oninput="formatRupiah(this)">
    </div>
  </div>
  <small>‚èé Tekan ENTER untuk langsung menambah barang</small>
</div>

<table id="tabel">
<tr><th>No</th><th>Barang<br><small>(klik untuk edit)</small></th><th>Qty</th><th>Harga</th><th>Total</th><th>Aksi</th></tr>
</table>

<h3>Grand Total: Rp <span id="grand">0</span></h3>
<label>Jumlah Transfer (TF)</label>
<input type="text" id="tf" tabindex="4" oninput="formatRupiah(this); hitungSisa()">
<h3><span id="labelSisa">Sisa</span> : Rp <span id="sisa">0</span></h3>

<div class="controls">
  <button class="small" onclick="shareWA()">üì§ Share WhatsApp</button>
  <button class="small" onclick="window.print()">üñ® Print</button>
</div>

<script>
const barangEl=document.getElementById('iBarang');
const qtyEl=document.getElementById('iQty');
const hargaEl=document.getElementById('iHarga');
const tfEl=document.getElementById('tf');
const tabel=document.getElementById('tabel');
const grandEl=document.getElementById('grand');
const sisaEl=document.getElementById('sisa');
const labelSisa=document.getElementById('labelSisa');

function angka(v){return Number(String(v).replace(/\D/g,''))||0}
function rupiah(n){return Number(n).toLocaleString('id-ID')}
function formatRupiah(el){el.value=rupiah(angka(el.value))}

function tambah(){
  const b=barangEl.value.trim();
  const q=Number(qtyEl.value);
  const h=angka(hargaEl.value);
  if(!b||q<=0||h<=0) return;
  const tr=document.createElement('tr');
  tr.innerHTML=`
    <td></td>
    <td contenteditable oninput="update()">${b}</td>
    <td contenteditable oninput="update()">${q}</td>
    <td contenteditable oninput="formatCellHarga(this)">${rupiah(h)}</td>
    <td class="total"></td>
    <td><button onclick="this.closest('tr').remove();update()">‚ùå</button></td>`;
  tabel.appendChild(tr);
  barangEl.value=qtyEl.value=hargaEl.value='';
  barangEl.focus();
  update();
}

function formatCellHarga(td){td.innerText=rupiah(angka(td.innerText));update()}

function update(){
  let grand=0;
  document.querySelectorAll('#tabel tr').forEach((tr,i)=>{
    if(i===0) return;
    tr.children[0].innerText=i;
    const q=angka(tr.children[2].innerText);
    const h=angka(tr.children[3].innerText);
    const t=q*h;
    tr.children[4].innerText=rupiah(t);
    grand+=t;
  });
  grandEl.innerText=rupiah(grand);
  hitungSisa();
}

function hitungSisa(){
  const s=angka(tfEl.value)-angka(grandEl.innerText);
  sisaEl.innerText=rupiah(Math.abs(s));
  labelSisa.innerText=s<0?'Kurang':s>0?'Kembali':'Pas';
  labelSisa.className=s<0?'minus':s>0?'plus':'';
}

function shareWA(){
  let items='';
  document.querySelectorAll('#tabel tr').forEach((tr,i)=>{
    if(i===0) return;
    items+=`${i}. ${tr.children[1].innerText} (${tr.children[2].innerText} x ${tr.children[3].innerText}) = Rp ${tr.children[4].innerText}\n`;
  });

  const text=
`*ZALTA GIFT*
Barahan RT 05 RW 02 Tarub
Tawangharjo, Grobogan
HP/WA: 08816575574 / 081476698677

Tanggal : ${new Date().toLocaleDateString('id-ID')}
Jam     : ${new Date().toLocaleTimeString('id-ID')}
--------------------------------
${items}--------------------------------
TOTAL : Rp ${grandEl.innerText}
TF    : Rp ${rupiah(angka(tfEl.value))}
${labelSisa.innerText.toUpperCase()} : Rp ${sisaEl.innerText}
--------------------------------
Terima kasih üôè`;

  window.open('https://wa.me/?text='+encodeURIComponent(text));
}

['iBarang','iQty','iHarga'].forEach(id=>{
  document.getElementById(id).addEventListener('keydown',e=>{
    if(e.key==='Enter'){e.preventDefault();tambah();}
  });
});

setInterval(()=>{document.getElementById('datetime').innerText=new Date().toLocaleString('id-ID')},1000);
</script>
</body>
</html>
